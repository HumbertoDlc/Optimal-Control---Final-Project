%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%                                                                 %%%%%
%%%%%                         OPTIMAL CONTROL                         %%%%%
%%%%%                                                                 %%%%%
%%%%%                                                                 %%%%%
%%%%%                          Final Project                          %%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

close all
clear
clc

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% Optimization parameters:
R=[0,0,0,10,10,1];          % Weighting factor.
x0=[3*pi/4;pi/2;pi/4;3*pi/8;pi/4;...
    0;0;0;0;0];       % Initial conditions.
p0=[1;1;1;1;1;...
    1;1;1;1;1].*0;             % Initial guess for p.
dt = 0.001;                  % Time sample.
tf = 0.05;                     % Final time.
ep=0.0001;                   % Gradient descent step size.
u0=1;                     % Initial control input.
plots=1;                    % Plot only if its value is 1.

J_arr=OP_GD (x0,p0,u0,dt,tf,ep,plots);

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% Optimal control by gradient descent:
function J=OP_GD (x0,p0,u0,dt,tf,ep,plots)

    J=inf;
    J_prev=0;
    Norm_Ph_Pu=ones(6,1).*inf;
    t0=0;
    time = t0 : dt : tf;
    N=length(time);
    u=ones(6,N).*u0;u(6,:)=-ones(1,N)*u0;
    i=0;

    while ((norm(Norm_Ph_Pu) > 0.1)&&(abs(J-J_prev) > 1e-4)) 
    
        Norm_Ph_Pu;u;
        [~,x]=ode(@state_eqn,dt,x0);
        [~,p]=ode(@costate_eqn,-dt,p0);
        p=fliplr(p);
        grad_4=2.1*p(9,:) + 10.0*u(4,:) - 1.5e3;
        grad_5=25.0*p(10,:) + 10.0*u(5,:) - 1.5e3;
        for ij=1:1:length(x(1,:))
            p4=p(4,ij);p5=p(5,ij);
            p6=p(6,ij);p7=p(7,ij);p8=p(8,ij);p9=p(9,ij);p10=p(10,ij);
            q4=x(4,ij);q5=x(5,ij);
            grad_6(ij)=(1.0e-56*(3.0e65*p8 - 2.7e64*p7 - 5.0e64*p6 + 2.0e56*u6*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.3e65*p6*cos(q4 + q5) - 3.3e65*p7*cos(q4 + q5) - 8.1e64*p8*cos(q4 + q5) - 2.2e66*p9*cos(q4 + q5) - 2.6e67*p10*cos(q4 + q5) + 4.2e64*p6*sin(q4 + q5) + 1.9e65*p7*sin(q4 + q5) + 3.0e65*p8*sin(q4 + q5) + 1.4e66*p9*sin(q4 + q5) + 1.6e67*p10*sin(q4 + q5) - 1.6e65*p6*cos(q4) - 4.1e65*p7*cos(q4) - 9.8e64*p8*cos(q4) - 2.7e66*p9*cos(q4) + 5.1e64*p6*sin(q4) + 2.3e65*p7*sin(q4) + 3.7e65*p8*sin(q4) + 1.7e66*p9*sin(q4) + 2.7e67*p10*sin(q5)))/(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2);
        end
        Norm_Ph_Pu(1) = 0;
        Norm_Ph_Pu(2) = 0;
        Norm_Ph_Pu(3) = 0;
        Norm_Ph_Pu(4) = (trapz(time,(grad_4).^2)).^0.5;
        Norm_Ph_Pu(5) = (trapz(time,(grad_5).^2)).^0.5;
        Norm_Ph_Pu(6) = (trapz(time,(grad_6).^2)).^0.5;
        J_prev=J;
        J=trapz(time,5*(ones(1,N).*150-u(4,:)).^2+5*(ones(1,N).*150-u(5,:)).^2+u(6,:).^2+50*x(4,:).^2+50*x(5,:).^2);
        i=i+1;
        J_arr(i)=J;
        disp(['Iteration #',num2str(i),', Hu = ',num2str(norm(Norm_Ph_Pu)),'.']);
        u(1,:) = 0; u(2,:) = 0; u(3,:) = 0;
        u(4,:) = u(4,:) - ep*(grad_4);
        u(5,:) = u(5,:) - ep*(grad_5);
        u(6,:) = u(6,:) - ep*(grad_6);
    end%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% State Equations:
function x_dot=state_eqn(k,x)   

    q4=x(4);q5=x(5);q4dot=x(9);q5dot=x(10);
    u4=u(4,k);u5=u(5,k);u6=u(6,k);
    x_dot(1:5,1)=x(6:10);
    x_dot(6:8,1)=0;
    x_dot(9,1)=(4.4e-26*(4.1e26*cos(q4)*(2.7e21*cos(q4) + 3.6e21*cos(q5) + 4.3e21*sin(q4) + 2.2e21*cos(q4)*cos(q5) + 3.5e21*cos(q4)*sin(q5) + 3.5e21*cos(q5)*sin(q4) - 2.2e21*sin(q4)*sin(q5) + 6.6e21)^(1/2) + 4.1e26*sin(q4)*(2.7e21*cos(q4) + 3.6e21*cos(q5) + 4.3e21*sin(q4) + 2.2e21*cos(q4)*cos(q5) + 3.5e21*cos(q4)*sin(q5) + 3.5e21*cos(q5)*sin(q4) - 2.2e21*sin(q4)*sin(q5) + 6.6e21)^(1/2) - 6.0e35*u6*cos(q4) + 3.8e35*u6*sin(q4) + 4.7e25*u4*(2.7e21*cos(q4) + 3.6e21*cos(q5) + 4.3e21*sin(q4) + 2.2e21*cos(q4)*cos(q5) + 3.5e21*cos(q4)*sin(q5) + 3.5e21*cos(q5)*sin(q4) - 2.2e21*sin(q4)*sin(q5) + 6.6e21)^(1/2) + 3.3e24*q5dot^2*sin(q5)*(2.7e21*cos(q4) + 3.6e21*cos(q5) + 4.3e21*sin(q4) + 2.2e21*cos(q4)*cos(q5) + 3.5e21*cos(q4)*sin(q5) + 3.5e21*cos(q5)*sin(q4) - 2.2e21*sin(q4)*sin(q5) + 6.6e21)^(1/2) + 8.2e25*cos(q4)*sin(q5)*(2.7e21*cos(q4) + 3.6e21*cos(q5) + 4.3e21*sin(q4) + 2.2e21*cos(q4)*cos(q5) + 3.5e21*cos(q4)*sin(q5) + 3.5e21*cos(q5)*sin(q4) - 2.2e21*sin(q4)*sin(q5) + 6.6e21)^(1/2) + 8.2e25*cos(q5)*sin(q4)*(2.7e21*cos(q4) + 3.6e21*cos(q5) + 4.3e21*sin(q4) + 2.2e21*cos(q4)*cos(q5) + 3.5e21*cos(q4)*sin(q5) + 3.5e21*cos(q5)*sin(q4) - 2.2e21*sin(q4)*sin(q5) + 6.6e21)^(1/2) - 8.2e25*sin(q4)*sin(q5)*(2.7e21*cos(q4) + 3.6e21*cos(q5) + 4.3e21*sin(q4) + 2.2e21*cos(q4)*cos(q5) + 3.5e21*cos(q4)*sin(q5) + 3.5e21*cos(q5)*sin(q4) - 2.2e21*sin(q4)*sin(q5) + 6.6e21)^(1/2) - 5.0e35*u6*cos(q4)*cos(q5) + 3.1e35*u6*cos(q4)*sin(q5) + 3.1e35*u6*cos(q5)*sin(q4) + 5.0e35*u6*sin(q4)*sin(q5) + 8.2e25*cos(q4)*cos(q5)*(2.7e21*cos(q4) + 3.6e21*cos(q5) + 4.3e21*sin(q4) + 2.2e21*cos(q4)*cos(q5) + 3.5e21*cos(q4)*sin(q5) + 3.5e21*cos(q5)*sin(q4) - 2.2e21*sin(q4)*sin(q5) + 6.6e21)^(1/2) + 6.6e24*q4dot*q5dot*sin(q5)*(2.7e21*cos(q4) + 3.6e21*cos(q5) + 4.3e21*sin(q4) + 2.2e21*cos(q4)*cos(q5) + 3.5e21*cos(q4)*sin(q5) + 3.5e21*cos(q5)*sin(q4) - 2.2e21*sin(q4)*sin(q5) + 6.6e21)^(1/2)))/(2.7e21*cos(q4) + 3.6e21*cos(q5) + 4.3e21*sin(q4) + 2.2e21*cos(q4)*cos(q5) + 3.5e21*cos(q4)*sin(q5) + 3.5e21*cos(q5)*sin(q4) - 2.2e21*sin(q4)*sin(q5) + 6.6e21)^(1/2);
    x_dot(10,1)=(2.1e-24*(2.1e25*sin(q4 + q5)*(2.7e21*cos(q4) + 3.6e21*cos(q5) + 4.3e21*sin(q4) + 2.2e21*cos(q4)*cos(q5) + 3.5e21*cos(q4)*sin(q5) + 3.5e21*cos(q5)*sin(q4) - 2.2e21*sin(q4)*sin(q5) + 6.6e21)^(1/2) - 1.2e35*u6*cos(q4 + q5) + 7.8e34*u6*sin(q4 + q5) + 1.3e35*u6*sin(q5) + 1.2e25*u5*(2.7e21*cos(q4) + 3.6e21*cos(q5) + 4.3e21*sin(q4) + 2.2e21*cos(q4)*cos(q5) + 3.5e21*cos(q4)*sin(q5) + 3.5e21*cos(q5)*sin(q4) - 2.2e21*sin(q4)*sin(q5) + 6.6e21)^(1/2) + 2.1e25*cos(q4 + q5)*(2.7e21*cos(q4) + 3.6e21*cos(q5) + 4.3e21*sin(q4) + 2.2e21*cos(q4)*cos(q5) + 3.5e21*cos(q4)*sin(q5) + 3.5e21*cos(q5)*sin(q4) - 2.2e21*sin(q4)*sin(q5) + 6.6e21)^(1/2) - 8.2e23*q4dot^2*sin(q5)*(2.7e21*cos(q4) + 3.6e21*cos(q5) + 4.3e21*sin(q4) + 2.2e21*cos(q4)*cos(q5) + 3.5e21*cos(q4)*sin(q5) + 3.5e21*cos(q5)*sin(q4) - 2.2e21*sin(q4)*sin(q5) + 6.6e21)^(1/2)))/(2.7e21*cos(q4) + 3.6e21*cos(q5) + 4.3e21*sin(q4) + 2.2e21*cos(q4)*cos(q5) + 3.5e21*cos(q4)*sin(q5) + 3.5e21*cos(q5)*sin(q4) - 2.2e21*sin(q4)*sin(q5) + 6.6e21)^(1/2);

end

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% Costate Equations:
function pdot=costate_eqn(k,p)
    
    k=N-k+1;
    p4=p(4);p5=p(5);p6=p(6);p7=p(7);p8=p(8);
    p9=p(9);p10=p(10);
    q4=x(4,k);q5=x(5,k);q4dot=x(9,k);q5dot=x(10,k);
    
    u6=u(6,k);u1=u(1,k);u2=u(2,k);u4=u(4,k);u5=u(5,k);
    pdot(1:3,1)=0;
    pdot(4,1)=-(5.0e-48*(2.1e78*p6*u6 + 5.9e78*p7*u6 + 3.5e78*p8*u6 + 4.0e79*p9*u6 + 1.9e80*p10*u6 - 9.8e34*p6*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 2.0e35*p7*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 3.9e36*p9*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.4e37*p10*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.0e78*p6*u6*cos(q4) + 2.1e78*p6*u6*cos(q5) + 3.8e78*p7*u6*cos(q4) + 5.8e78*p7*u6*cos(q5) + 4.6e78*p8*u6*cos(q4) + 3.5e78*p8*u6*cos(q5) + 2.7e79*p9*u6*cos(q4) + 3.9e79*p9*u6*cos(q5) + 8.8e79*p10*u6*cos(q4) + 2.4e80*p10*u6*cos(q5) - 3.4e34*p6*q4dot^2*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 9.2e32*p6*q5dot^2*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.1e34*p7*q4dot^2*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 4.0e33*p7*q5dot^2*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 4.8e38*p6*cos(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 8.6e34*p6*cos(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 4.5e36*p7*cos(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 6.1e46*p6*cos(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 1.7e35*p7*cos(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 2.7e47*p7*cos(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) + 1.3e47*p8*cos(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) + 3.4e36*p9*cos(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 3.6e48*p9*cos(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) + 1.7e37*p10*cos(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.9e77*p6*u6*cos(2.0*q4 + 2.0*q5) + 2.5e45*p7*u6*cos(2.0*q4 - 1.0*q5) - 1.5e45*p7*u6*cos(2.0*q4 - 2.0*q5) - 3.8e77*p7*u6*cos(2.0*q4 + 2.0*q5) + 5.0e44*p8*u6*cos(2.0*q4 - 1.0*q5) + 1.9e77*p8*u6*cos(2.0*q4 + 2.0*q5) + 2.5e46*p9*u6*cos(2.0*q4 - 1.0*q5) - 2.4e78*p9*u6*cos(2.0*q4 + 2.0*q5) - 2.5e47*p10*u6*cos(2.0*q4 - 1.0*q5) + 1.5e47*p10*u6*cos(2.0*q4 - 2.0*q5) - 2.8e79*p10*u6*cos(2.0*q4 + 2.0*q5) + 2.5e78*p6*u6*sin(q4) - 8.7e67*p6*u6*sin(q5) + 6.5e78*p7*u6*sin(q4) - 1.5e68*p7*u6*sin(q5) + 2.4e78*p8*u6*sin(q4) - 1.8e68*p8*u6*sin(q5) + 4.3e79*p9*u6*sin(q4) - 3.9e69*p9*u6*sin(q5) + 1.4e80*p10*u6*sin(q4) - 2.3e70*p10*u6*sin(q5) - 6.0e34*p6*cos(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.2e35*p7*cos(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 2.4e36*p9*cos(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 5.9e37*p10*cos(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 3.0e38*p6*sin(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 2.3e35*p6*sin(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 2.8e36*p7*sin(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 6.1e46*p6*sin(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) + 4.5e35*p7*sin(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 2.7e47*p7*sin(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 1.3e47*p8*sin(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 8.9e36*p9*sin(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 3.6e48*p9*sin(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) + 7.2e37*p10*sin(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 2.2e77*p6*u6*sin(2.0*q4 + 2.0*q5) - 2.5e45*p7*u6*sin(2.0*q4 - 1.0*q5) + 6.9e77*p7*u6*sin(2.0*q4 + 2.0*q5) + 6.2e77*p8*u6*sin(2.0*q4 + 2.0*q5) - 2.5e46*p9*u6*sin(2.0*q4 - 1.0*q5) + 4.8e78*p9*u6*sin(2.0*q4 + 2.0*q5) + 5.8e79*p10*u6*sin(2.0*q4 + 2.0*q5) + 255.0*p6*sin(2.0*q4 - 1.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.4e34*p6*sin(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 2.8e34*p7*sin(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 5.4e35*p9*sin(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 5.0e4*p10*sin(2.0*q4 - 1.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.4e37*p10*sin(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.8e77*p6*u6*cos(q4 - 1.0*q5) + 1.5e77*p6*u6*cos(q4 + 2.0*q5) - 4.6e77*p6*u6*cos(2.0*q4 + q5) + 8.0e77*p7*u6*cos(q4 - 1.0*q5) + 6.6e77*p7*u6*cos(q4 + 2.0*q5) - 9.3e77*p7*u6*cos(2.0*q4 + q5) + 1.3e78*p8*u6*cos(q4 - 1.0*q5) + 1.1e78*p8*u6*cos(q4 + 2.0*q5) + 4.6e77*p8*u6*cos(2.0*q4 + q5) + 5.9e78*p9*u6*cos(q4 - 1.0*q5) + 4.9e78*p9*u6*cos(q4 + 2.0*q5) - 5.7e78*p9*u6*cos(2.0*q4 + q5) + 3.6e79*p10*u6*cos(q4 - 1.0*q5) + 2.9e79*p10*u6*cos(q4 + 2.0*q5) - 3.4e79*p10*u6*cos(2.0*q4 + q5) - 3.7e35*p6*cos(2.0*q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 7.4e35*p7*cos(2.0*q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.5e37*p9*cos(2.0*q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 7.2e37*p10*cos(2.0*q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 5.8e77*p6*u6*sin(q4 - 1.0*q5) + 4.8e77*p6*u6*sin(q4 + 2.0*q5) + 5.4e77*p6*u6*sin(2.0*q4 + q5) + 1.4e78*p7*u6*sin(q4 - 1.0*q5) + 1.2e78*p7*u6*sin(q4 + 2.0*q5) + 1.7e78*p7*u6*sin(2.0*q4 + q5) + 3.5e77*p8*u6*sin(q4 - 1.0*q5) + 2.9e77*p8*u6*sin(q4 + 2.0*q5) + 1.5e78*p8*u6*sin(2.0*q4 + q5) + 9.5e78*p9*u6*sin(q4 - 1.0*q5) + 7.8e78*p9*u6*sin(q4 + 2.0*q5) + 1.2e79*p9*u6*sin(2.0*q4 + q5) + 5.7e79*p10*u6*sin(q4 - 1.0*q5) + 4.7e79*p10*u6*sin(q4 + 2.0*q5) + 7.1e79*p10*u6*sin(2.0*q4 + q5) - 8.6e34*p6*sin(2.0*q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.7e35*p7*sin(2.0*q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 3.4e36*p9*sin(2.0*q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.7e37*p10*sin(2.0*q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 2.8e77*p6*u6*cos(2.0*q4) - 5.7e77*p7*u6*cos(2.0*q4) + 2.8e77*p8*u6*cos(2.0*q4) - 3.5e78*p9*u6*cos(2.0*q4) - 3.6e35*p6*cos(2.0*q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 7.3e35*p7*cos(2.0*q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.4e37*p9*cos(2.0*q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 3.3e77*p6*u6*sin(2.0*q4) + 1.0e78*p7*u6*sin(2.0*q4) + 9.2e77*p8*u6*sin(2.0*q4) + 7.2e78*p9*u6*sin(2.0*q4) - 8.4e34*p6*sin(2.0*q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.7e35*p7*sin(2.0*q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 3.3e36*p9*sin(2.0*q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 9.2e77*p6*u6*cos(q4 + q5) + 3.3e78*p7*u6*cos(q4 + q5) + 4.2e78*p8*u6*cos(q4 + q5) + 2.4e79*p9*u6*cos(q4 + q5) + 1.8e80*p10*u6*cos(q4 + q5) + 3.9e38*p6*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 3.7e36*p7*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.2e46*p6*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) + 5.4e46*p7*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) + 2.7e46*p8*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) + 7.3e47*p9*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) + 8.7e48*p10*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) + 2.2e78*p6*u6*sin(q4 + q5) + 5.8e78*p7*u6*sin(q4 + q5) + 2.1e78*p8*u6*sin(q4 + q5) + 3.8e79*p9*u6*sin(q4 + q5) + 2.9e80*p10*u6*sin(q4 + q5) - 2.5e38*p6*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 2.3e36*p7*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.2e46*p6*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 5.4e46*p7*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 2.7e46*p8*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 7.3e47*p9*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 8.7e48*p10*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) + 25.0*p6*q4dot^2*sin(2.0*q4 - 1.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.2e32*p6*q4dot^2*sin(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 2.0*p6*q5dot^2*sin(2.0*q4 - 1.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 20.0*p7*q4dot^2*sin(2.0*q4 - 1.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.2e32*p6*q5dot^2*sin(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 3.4e33*p7*q4dot^2*sin(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 5.0*p7*q5dot^2*sin(2.0*q4 - 1.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 3.4e33*p7*q5dot^2*sin(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 8.2e33*p6*q4dot*q5dot*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.1e34*p7*q4dot*q5dot*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 2.8e34*p6*q4dot^2*cos(2.0*q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 7.3e32*p6*q5dot^2*cos(q4 - 1.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 6.0e32*p6*q5dot^2*cos(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 2.3e33*p6*q5dot^2*cos(2.0*q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 2.7e34*p7*q4dot^2*cos(2.0*q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 5.1e32*p7*q5dot^2*cos(q4 - 1.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 4.2e32*p7*q5dot^2*cos(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 2.6e33*p7*q5dot^2*cos(2.0*q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 4.4e34*p9*q5dot^2*cos(q4 - 1.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.1e36*p10*q4dot^2*cos(q4 - 1.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 3.6e34*p9*q5dot^2*cos(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 9.1e35*p10*q4dot^2*cos(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 4.2e34*p6*u1*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 8.5e34*p7*u2*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.7e36*p9*u4*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 4.2e37*p10*u5*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.7e34*p6*q4dot^2*sin(2.0*q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.2e33*p6*q5dot^2*sin(q4 - 1.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 9.6e32*p6*q5dot^2*sin(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.5e32*p6*q5dot^2*sin(2.0*q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.6e33*p7*q4dot^2*sin(2.0*q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 8.2e32*p7*q5dot^2*sin(q4 - 1.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 6.7e32*p7*q5dot^2*sin(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 4.2e33*p7*q5dot^2*sin(2.0*q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 7.1e34*p9*q5dot^2*sin(q4 - 1.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.8e36*p10*q4dot^2*sin(q4 - 1.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 5.8e34*p9*q5dot^2*sin(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.5e36*p10*q4dot^2*sin(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 2.6e34*p6*u1*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 5.3e34*p7*u2*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.0e36*p9*u4*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 2.6e37*p10*u5*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 3.7e34*p6*q4dot^2*cos(2.0*q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 3.0e34*p7*q4dot^2*cos(2.0*q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 5.2e34*p6*u1*cos(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.0e35*p7*u2*cos(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 2.0e36*p9*u4*cos(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 5.1e37*p10*u5*cos(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 2.1e34*p6*q4dot^2*sin(2.0*q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 7.0e33*p7*q4dot^2*sin(2.0*q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 3.2e34*p6*u1*sin(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 6.4e34*p7*u2*sin(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.3e36*p9*u4*sin(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 3.2e37*p10*u5*sin(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 7.3e32*p6*q5dot^2*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 2.5e44*p6*q4dot^2*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 5.1e32*p7*q5dot^2*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 2.5e44*p6*q5dot^2*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 1.1e45*p7*q4dot^2*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 1.1e45*p7*q5dot^2*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 3.3e45*p8*q4dot^2*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) + 4.4e34*p9*q5dot^2*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.1e36*p10*q4dot^2*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 3.3e45*p8*q5dot^2*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 1.2e33*p6*q5dot^2*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.3e45*p6*q4dot^2*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 8.2e32*p7*q5dot^2*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.3e45*p6*q5dot^2*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 2.2e45*p7*q4dot^2*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 2.2e45*p7*q5dot^2*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) + 7.1e34*p9*q5dot^2*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.8e36*p10*q4dot^2*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 2.7e34*p6*q4dot^2*cos(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 6.0e32*p6*q5dot^2*cos(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.2e45*p6*q4dot^2*cos(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) + 1.1e33*p6*q5dot^2*cos(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.1e34*p7*q4dot^2*cos(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 4.2e32*p7*q5dot^2*cos(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 5.5e45*p7*q4dot^2*cos(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 4.9e33*p7*q5dot^2*cos(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.6e46*p8*q4dot^2*cos(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 3.6e34*p9*q5dot^2*cos(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 9.1e35*p10*q4dot^2*cos(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 2.5*p6*q4dot^2*cos(2.0*q4 - 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.9e33*p6*q4dot^2*cos(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 2.5*p6*q5dot^2*cos(2.0*q4 - 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.9e33*p6*q5dot^2*cos(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 2.1e33*p7*q4dot^2*cos(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 2.1e33*p7*q5dot^2*cos(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 2.2e34*p6*q4dot^2*sin(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 9.6e32*p6*q5dot^2*sin(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 6.3e45*p6*q4dot^2*sin(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) + 2.0e33*p6*q5dot^2*sin(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 2.4e34*p7*q4dot^2*sin(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 6.7e32*p7*q5dot^2*sin(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.1e46*p7*q4dot^2*sin(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 4.9e32*p7*q5dot^2*sin(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 5.8e34*p9*q5dot^2*sin(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.5e36*p10*q4dot^2*sin(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 3.1e33*p6*q4dot*q5dot*cos(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.0e34*p6*q4dot*q5dot*cos(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 9.4e33*p7*q4dot*q5dot*cos(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.4e34*p7*q4dot*q5dot*cos(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 7.3e34*p9*q4dot*q5dot*cos(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 7.0e33*p6*q4dot*q5dot*cos(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 25.0*p7*q4dot*q5dot*cos(2.0*q4 - 1.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.0e34*p7*q4dot*q5dot*cos(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 5.0e33*p6*q4dot*q5dot*sin(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 4.6e33*p6*q4dot*q5dot*sin(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.5e34*p7*q4dot*q5dot*sin(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 7.2e33*p7*q4dot*q5dot*sin(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.2e35*p9*q4dot*q5dot*sin(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 5.7e33*p6*q4dot*q5dot*sin(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 7.4e33*p7*q4dot*q5dot*sin(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 3.8e33*p6*q4dot*q5dot*cos(q4 - 1.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 3.1e33*p6*q4dot*q5dot*cos(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 8.5e33*p6*q4dot*q5dot*cos(2.0*q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.1e34*p7*q4dot*q5dot*cos(q4 - 1.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 9.4e33*p7*q4dot*q5dot*cos(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.2e34*p7*q4dot*q5dot*cos(2.0*q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 8.8e34*p9*q4dot*q5dot*cos(q4 - 1.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 7.3e34*p9*q4dot*q5dot*cos(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 6.1e33*p6*q4dot*q5dot*sin(q4 - 1.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 5.0e33*p6*q4dot*q5dot*sin(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 7.0e33*p6*q4dot*q5dot*sin(2.0*q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.8e34*p7*q4dot*q5dot*sin(q4 - 1.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.5e34*p7*q4dot*q5dot*sin(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 9.0e33*p7*q4dot*q5dot*sin(2.0*q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.4e35*p9*q4dot*q5dot*sin(q4 - 1.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.2e35*p9*q4dot*q5dot*sin(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 3.8e33*p6*q4dot*q5dot*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.1e34*p7*q4dot*q5dot*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 5.0e44*p6*q4dot*q5dot*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 2.2e45*p7*q4dot*q5dot*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) + 8.8e34*p9*q4dot*q5dot*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 6.6e45*p8*q4dot*q5dot*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 6.1e33*p6*q4dot*q5dot*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.8e34*p7*q4dot*q5dot*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 2.5e45*p6*q4dot*q5dot*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 4.5e45*p7*q4dot*q5dot*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) + 1.4e35*p9*q4dot*q5dot*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2)))/(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2);
    pdot(5,1)=-(5.0e-48*(8.5e77*p6*u6 + 2.4e78*p7*u6 + 1.4e78*p8*u6 + 1.6e79*p9*u6 + 3.4e80*p10*u6 - 1.4e34*p6*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 2.8e34*p7*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 5.4e35*p9*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.4e37*p10*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 2.3e77*p6*u6*cos(q4) + 1.0e78*p6*u6*cos(q5) + 9.9e77*p7*u6*cos(q4) + 2.9e78*p7*u6*cos(q5) + 1.6e78*p8*u6*cos(q4) + 1.7e78*p8*u6*cos(q5) + 7.3e78*p9*u6*cos(q4) + 2.0e79*p9*u6*cos(q5) + 1.8e80*p10*u6*cos(q4) + 5.1e80*p10*u6*cos(q5) + 9.2e32*p6*q4dot^2*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.9e33*p6*q5dot^2*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 4.0e33*p7*q4dot^2*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 3.3e33*p7*q5dot^2*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 5.9e34*p9*q5dot^2*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.5e36*p10*q4dot^2*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 3.7e34*p6*cos(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 6.9e34*p6*cos(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 7.4e34*p7*cos(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.4e35*p7*cos(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.5e36*p9*cos(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 2.7e36*p9*cos(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 3.7e37*p10*cos(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.9e77*p6*u6*cos(2.0*q4 + 2.0*q5) - 1.5e45*p7*u6*cos(2.0*q4 - 1.0*q5) - 1.5e45*p7*u6*cos(2.0*q4 - 2.0*q5) - 3.8e77*p7*u6*cos(2.0*q4 + 2.0*q5) + 1.9e77*p8*u6*cos(2.0*q4 + 2.0*q5) - 2.4e78*p9*u6*cos(2.0*q4 + 2.0*q5) - 2.5e47*p10*u6*cos(2.0*q4 - 1.0*q5) + 1.5e47*p10*u6*cos(2.0*q4 - 2.0*q5) - 2.8e79*p10*u6*cos(2.0*q4 + 2.0*q5) + 7.1e77*p6*u6*sin(q4) - 8.8e76*p6*u6*sin(q5) + 1.8e78*p7*u6*sin(q4) - 4.9e76*p7*u6*sin(q5) + 4.3e77*p8*u6*sin(q4) + 5.4e77*p8*u6*sin(q5) + 1.2e79*p9*u6*sin(q4) - 1.9e69*p9*u6*sin(q5) + 2.8e80*p10*u6*sin(q4) - 1.5e70*p10*u6*sin(q5) - 6.0e34*p6*cos(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.2e35*p7*cos(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 2.5e4*p9*cos(2.0*q4 - 1.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 2.4e36*p9*cos(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 5.9e37*p10*cos(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 3.7e34*p6*sin(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 4.0e38*p6*sin(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 7.4e34*p7*sin(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 3.2e36*p7*sin(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.5e36*p9*sin(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.2e37*p9*sin(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 3.7e37*p10*sin(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 2.2e77*p6*u6*sin(2.0*q4 + 2.0*q5) + 6.9e77*p7*u6*sin(2.0*q4 + 2.0*q5) + 6.2e77*p8*u6*sin(2.0*q4 + 2.0*q5) + 4.8e78*p9*u6*sin(2.0*q4 + 2.0*q5) - 2.5e47*p10*u6*sin(2.0*q4 - 1.0*q5) + 5.8e79*p10*u6*sin(2.0*q4 + 2.0*q5) + 255.0*p6*sin(2.0*q4 - 1.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.4e34*p6*sin(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 2.8e34*p7*sin(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 5.4e35*p9*sin(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.4e37*p10*sin(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 9.2e76*p6*u6*cos(q4 - 1.0*q5) + 7.5e76*p6*u6*cos(q4 + 2.0*q5) - 2.3e77*p6*u6*cos(2.0*q4 + q5) + 4.0e77*p7*u6*cos(q4 - 1.0*q5) + 3.3e77*p7*u6*cos(q4 + 2.0*q5) - 4.7e77*p7*u6*cos(2.0*q4 + q5) + 6.6e77*p8*u6*cos(q4 - 1.0*q5) + 5.4e77*p8*u6*cos(q4 + 2.0*q5) + 2.3e77*p8*u6*cos(2.0*q4 + q5) + 3.0e78*p9*u6*cos(q4 - 1.0*q5) + 2.4e78*p9*u6*cos(q4 + 2.0*q5) - 2.9e78*p9*u6*cos(2.0*q4 + q5) + 7.1e79*p10*u6*cos(q4 - 1.0*q5) + 2.5e47*p10*u6*cos(q4 - 2.0*q5) + 5.9e79*p10*u6*cos(q4 + 2.0*q5) - 6.9e79*p10*u6*cos(2.0*q4 + q5) + 1.9e35*p6*cos(q4 - 1.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 3.7e34*p6*cos(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 3.0e35*p6*cos(2.0*q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 3.7e35*p7*cos(q4 - 1.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 7.4e34*p7*cos(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 6.0e35*p7*cos(2.0*q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 7.3e36*p9*cos(q4 - 1.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.5e36*p9*cos(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.2e37*p9*cos(2.0*q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 3.7e37*p10*cos(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 2.9e77*p6*u6*sin(q4 - 1.0*q5) + 2.4e77*p6*u6*sin(q4 + 2.0*q5) + 2.7e77*p6*u6*sin(2.0*q4 + q5) + 7.2e77*p7*u6*sin(q4 - 1.0*q5) + 2.5e45*p7*u6*sin(q4 - 2.0*q5) + 5.9e77*p7*u6*sin(q4 + 2.0*q5) + 8.5e77*p7*u6*sin(2.0*q4 + q5) + 1.8e77*p8*u6*sin(q4 - 1.0*q5) - 5.0e44*p8*u6*sin(q4 - 2.0*q5) + 1.4e77*p8*u6*sin(q4 + 2.0*q5) + 7.6e77*p8*u6*sin(2.0*q4 + q5) + 4.8e78*p9*u6*sin(q4 - 1.0*q5) + 3.9e78*p9*u6*sin(q4 + 2.0*q5) + 5.9e78*p9*u6*sin(2.0*q4 + q5) + 1.1e80*p10*u6*sin(q4 - 1.0*q5) + 9.4e79*p10*u6*sin(q4 + 2.0*q5) + 1.4e80*p10*u6*sin(2.0*q4 + q5) - 1.9e35*p6*sin(q4 - 1.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 3.7e34*p6*sin(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 6.9e34*p6*sin(2.0*q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 3.7e35*p7*sin(q4 - 1.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 7.4e34*p7*sin(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.4e35*p7*sin(2.0*q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 7.3e36*p9*sin(q4 - 1.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.5e36*p9*sin(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 2.7e36*p9*sin(2.0*q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 3.7e37*p10*sin(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 4.7e79*p10*u6*cos(2.0*q5) + 6.4e77*p6*u6*cos(q4 + q5) + 2.1e78*p7*u6*cos(q4 + q5) + 2.3e78*p8*u6*cos(q4 + q5) + 1.5e79*p9*u6*cos(q4 + q5) + 2.9e80*p10*u6*cos(q4 + q5) + 3.9e38*p6*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 3.3e36*p7*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.2e46*p6*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) + 5.4e46*p7*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) + 7.3e36*p9*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 2.7e46*p8*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) + 7.3e47*p9*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) + 8.7e48*p10*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) + 1.4e78*p6*u6*sin(q4 + q5) + 3.6e78*p7*u6*sin(q4 + q5) + 1.6e78*p8*u6*sin(q4 + q5) + 2.4e79*p9*u6*sin(q4 + q5) + 4.6e80*p10*u6*sin(q4 + q5) - 2.5e38*p6*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.9e36*p7*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.2e46*p6*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 5.4e46*p7*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 7.3e36*p9*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 2.7e46*p8*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 7.3e47*p9*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 8.7e48*p10*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 1.2e32*p6*q4dot^2*sin(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 25.0*p7*q4dot^2*sin(2.0*q4 - 1.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.2e32*p6*q5dot^2*sin(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 3.4e33*p7*q4dot^2*sin(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 3.4e33*p7*q5dot^2*sin(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 3.1e33*p6*q4dot*q5dot*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 4.0e33*p7*q4dot*q5dot*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.2e35*p9*q4dot*q5dot*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.5e33*p6*q4dot^2*cos(q4 - 1.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 7.6e32*p6*q4dot^2*cos(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 3.0e34*p6*q4dot^2*cos(2.0*q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.5e34*p7*q4dot^2*cos(q4 - 1.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.6e32*p6*q5dot^2*cos(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.5e33*p7*q4dot^2*cos(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 2.5e34*p7*q4dot^2*cos(2.0*q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.1e33*p7*q5dot^2*cos(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 3.6e34*p9*q5dot^2*cos(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 9.1e35*p10*q4dot^2*cos(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 4.2e34*p6*u1*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 8.5e34*p7*u2*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.7e36*p9*u4*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 4.2e37*p10*u5*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 3.0e34*p6*q4dot^2*sin(q4 - 1.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.4e33*p6*q4dot^2*sin(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.7e34*p6*q4dot^2*sin(2.0*q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.5e34*p7*q4dot^2*sin(q4 - 1.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 2.4e33*p6*q5dot^2*sin(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 3.1e33*p7*q4dot^2*sin(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 5.8e33*p7*q4dot^2*sin(2.0*q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 2.4e33*p7*q5dot^2*sin(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 5.8e34*p9*q5dot^2*sin(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.5e36*p10*q4dot^2*sin(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 2.6e34*p6*u1*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 5.3e34*p7*u2*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.0e36*p9*u4*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 2.6e37*p10*u5*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 9.7e32*p6*q5dot^2*cos(2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 6.8e32*p7*q5dot^2*cos(2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 5.9e34*p9*q5dot^2*cos(2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.5e36*p10*q4dot^2*cos(2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 4.3e34*p6*u1*sin(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 8.5e34*p7*u2*sin(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.7e36*p9*u4*sin(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 4.2e37*p10*u5*sin(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.5e33*p6*q4dot^2*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.5e34*p7*q4dot^2*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 2.5e44*p6*q4dot^2*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 2.5e44*p6*q5dot^2*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 1.1e45*p7*q4dot^2*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 1.1e45*p7*q5dot^2*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 3.3e45*p8*q4dot^2*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 3.3e45*p8*q5dot^2*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) + 3.0e34*p6*q4dot^2*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.5e34*p7*q4dot^2*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.3e45*p6*q4dot^2*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 1.3e45*p6*q5dot^2*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 2.2e45*p7*q4dot^2*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 2.2e45*p7*q5dot^2*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 7.6e32*p6*q4dot^2*cos(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 2.8e34*p6*q4dot^2*cos(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.6e32*p6*q5dot^2*cos(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.5e33*p7*q4dot^2*cos(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 5.7e33*p7*q4dot^2*cos(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.1e33*p7*q5dot^2*cos(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 4.9e44*p6*q5dot^2*cos(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 3.6e34*p9*q5dot^2*cos(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 9.1e35*p10*q4dot^2*cos(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 2.2e45*p7*q5dot^2*cos(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) + 1.1e45*p8*q5dot^2*cos(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) + 2.9e46*p9*q5dot^2*cos(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 3.5e47*p10*q4dot^2*cos(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 2.5*p6*q4dot^2*cos(2.0*q4 - 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.9e33*p6*q4dot^2*cos(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 2.5*p6*q5dot^2*cos(2.0*q4 - 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.9e33*p6*q5dot^2*cos(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 2.1e33*p7*q4dot^2*cos(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 2.1e33*p7*q5dot^2*cos(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.4e33*p6*q4dot^2*sin(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 2.0e34*p6*q4dot^2*sin(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 2.4e33*p6*q5dot^2*sin(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 3.1e33*p7*q4dot^2*sin(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 2.5e34*p7*q4dot^2*sin(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 2.4e33*p7*q5dot^2*sin(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 5.8e34*p9*q5dot^2*sin(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.5e36*p10*q4dot^2*sin(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 2.1e33*p6*q4dot*q5dot*cos(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 8.7e33*p7*q4dot*q5dot*cos(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 9.8e44*p6*q4dot*q5dot*cos(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 7.3e34*p9*q4dot*q5dot*cos(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 4.3e45*p7*q4dot*q5dot*cos(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) + 2.1e45*p8*q4dot*q5dot*cos(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) + 5.8e46*p9*q4dot*q5dot*cos(q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 7.0e33*p6*q4dot*q5dot*cos(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.0e34*p7*q4dot*q5dot*cos(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 2.6e33*p6*q4dot*q5dot*sin(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 4.3e33*p7*q4dot*q5dot*sin(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.2e35*p9*q4dot*q5dot*sin(q4)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 5.7e33*p6*q4dot*q5dot*sin(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 7.4e33*p7*q4dot*q5dot*sin(2.0*q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 2.1e33*p6*q4dot*q5dot*cos(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 8.7e33*p7*q4dot*q5dot*cos(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 7.3e34*p9*q4dot*q5dot*cos(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 2.6e33*p6*q4dot*q5dot*sin(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 4.3e33*p7*q4dot*q5dot*sin(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.2e35*p9*q4dot*q5dot*sin(q4 + 2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 5.1e33*p6*q4dot*q5dot*cos(2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 1.5e34*p7*q4dot*q5dot*cos(2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) + 1.2e35*p9*q4dot*q5dot*cos(2.0*q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(1/2) - 5.0e44*p6*q4dot*q5dot*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 2.2e45*p7*q4dot*q5dot*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 6.6e45*p8*q4dot*q5dot*cos(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 2.5e45*p6*q4dot*q5dot*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2) - 4.5e45*p7*q4dot*q5dot*sin(q4 + q5)*(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2)))/(5.1e21*cos(q4 - 1.0) + 3.6e21*cos(q5) + 4.2e21*cos(q4 + q5 - 1.0) + 6.6e21)^(3/2);
    pdot(6:8,1)=0;
    pdot(9,1)=0.012*p6*q4dot*sin(q4) - 100.0*q4dot - 0.063*p6*q4dot*cos(q4) - 0.11*p7*q4dot*cos(q4) - 1.0*p4 + 0.055*p7*q4dot*sin(q4) - 4.9e-3*p6*q5dot*sin(q5) + 0.16*p8*q4dot*sin(q4) - 0.022*p7*q5dot*sin(q5) - 0.011*p8*q5dot*sin(q5) - 0.29*p9*q5dot*sin(q5) + 3.5*p10*q4dot*sin(q5) - 0.013*p6*q4dot*cos(q4 + q5) - 0.013*p6*q5dot*cos(q4 + q5) - 0.022*p7*q4dot*cos(q4 + q5) - 0.022*p7*q5dot*cos(q4 + q5) + 2.5e-3*p6*q4dot*sin(q4 + q5) + 2.5e-3*p6*q5dot*sin(q4 + q5) + 0.011*p7*q4dot*sin(q4 + q5) + 0.011*p7*q5dot*sin(q4 + q5) + 0.033*p8*q4dot*sin(q4 + q5) + 0.033*p8*q5dot*sin(q4 + q5);
    pdot(10,1)=2.5e-3*p6*q4dot*sin(q4 + q5) - 100.0*q5dot - 4.9e-3*p6*q4dot*sin(q5) - 4.9e-3*p6*q5dot*sin(q5) - 0.022*p7*q4dot*sin(q5) - 0.022*p7*q5dot*sin(q5) - 0.011*p8*q4dot*sin(q5) - 0.011*p8*q5dot*sin(q5) - 0.29*p9*q4dot*sin(q5) - 0.29*p9*q5dot*sin(q5) - 0.013*p6*q4dot*cos(q4 + q5) - 0.013*p6*q5dot*cos(q4 + q5) - 0.022*p7*q4dot*cos(q4 + q5) - 0.022*p7*q5dot*cos(q4 + q5) - 1.0*p5 + 2.5e-3*p6*q5dot*sin(q4 + q5) + 0.011*p7*q4dot*sin(q4 + q5) + 0.011*p7*q5dot*sin(q4 + q5) + 0.033*p8*q4dot*sin(q4 + q5) + 0.033*p8*q5dot*sin(q4 + q5);
    
end

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% Ordinary differential Equations:
function [time_arr,x_arr]=ode(xdot,d_t,x_0)
    
    time_arr = zeros(1, N);
    x_arr = zeros(10, N);
    x_all=x_0;
    
        for j=1:1:N
            x_arr(:,j)  =   x_all;
            xdot_out    =   xdot(j, x_all);
            x_all       =   xdot_out*d_t+x_all;
        end

end

disp(['The total cost is: ',num2str(J),'.']);

if plots==1
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% Plots:
figure;subplot(2,2,1);plot(time,x(4,:),'b','linewidth',3);
title('Forth state: Shoulder joint-position.');
xlabel('Time (s)');ylabel('x_4');
subplot(2,2,2);plot(time,x(5,:),'b','linewidth',3);
title('Fiveth state: Elbow joint-position.');
xlabel('Time (s)');ylabel('x_5');

subplot(2,2,3);plot(time,x(9,:),'r','linewidth',3);
title('Nineth state: Shoulder joint-velocity.');
xlabel('Time (s)');ylabel('x_9');
subplot(2,2,4);plot(time,x(10,:),'r','linewidth',3);
title('Tenth state: Elbow joint-velocity.');
xlabel('Time (s)');ylabel('x_{10}');


figure;
subplot(2,1,1);plot(time,u(4:5,:),'linewidth',3);
title('Optimal Control Law');xlabel('Time (s)');ylabel('U^*')
legend('J_{Shoulder}','J_{Elbow}')
subplot(2,1,2);plot(time,u(6,:),'linewidth',3);
title('Optimal Control Law');xlabel('Time (s)');ylabel('U^*')
legend('External Force')


figure;scatter(1:1:length(J_arr),J_arr,120,'filled')
title('All Iterations.');
xlabel('Iteration (units)');ylabel('Cost Value');

save('x.mat','x','u');
end

end